---
title: 爬虫
date: 2017-12-05 11:23:09
tags:
---



## 学习资料
https://mp.weixin.qq.com/s/VNUaXDIXkoY55kPLZzvDNw

##Scrapy
### 安装
`conda install -c conda-forge scrapy`
### 创建工程
`scrapy startproject ArticleSpider`
### 配置 Pycharm使其可以断点 Scrapy
添加一个 main 函数,通过 scrapy.cmd.execute 来执行 scrapy 命令行
### XPath 语法
[XPath 语法](http://www.w3school.com.cn/xpath/xpath_syntax.asp)

*ps:如果你只想获得第一个匹配的，可以使用.extract_first()*

### tips
```python
from urllib import parse
parse.urljoin(base, url) # 在某些提取到到 href是一个相对路径是需要手动组装 url
```
![](https://ws4.sinaimg.cn/large/006tNc79gy1foykdbiw7wj31kw0bwwfc.jpg)
利用 scrapy 自带的 ImagesPipeline快速完成图片下载以及下载格式设置

pipLine 主要用来做数据存储

python3 里所有的字符都是 unicode, 需要 encode 才能被某些函数接受

codecs 来完成文件的打开和写入,可以避免很多文件编码的问题
mysql varchar 必须制定长度,很长的内容可以用 longtext 类型,不用指定长度

可以利用scrapy的 adbapi 可以实现异步存 mysql.

Requeset 对象不添加 callback 参数默认进入到`parse(self.Response)` 函数中
在 setting文件中COOKIES_ENABLED = True打开,这样后续的请求会自动带上 cookie

![](https://ws4.sinaimg.cn/large/006tNc79gy1fp7ot3u1p3j31kw0tvwjl.jpg)

## cookie 和 session 的关系与区别
cookie 是浏览器提供的一种机制
session 是后台的一种保存回话的机制. sessionId是 session 的 key(索引值),
通过返回给 client(浏览器),保存到 cookie 中来实现区别出clinet 的功能.而且安全
最原始是通过 cookie 直接保存账号密码的.[具体可以参考](https://coding.imooc.com/lesson/92.html#mid=2850)
### 多说一句
cookie 和 http 的 body 都可以用来传输数据.但是 cookie 里面的数据是每个请求都会带上的,而且是可以很容器
获取的,而 body 是每个请求特有的.这样,如果是所有请求都需要的数据就放到 cookie 里面去,而请求特有的数据那就
放到 body 里去.


### 文档
[scrapy](http://scrapy-chs.readthedocs.io/zh_CN/0.24/intro/tutorial.html)

[selenium](http://selenium-python-zh.readthedocs.io/en/latest/getting-started.html)

[Request](http://docs.python-requests.org/zh_CN/latest/index.html)
